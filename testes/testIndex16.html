<!-- navega√ß√£o  -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dark Page</title>

<script src="https://cdn.jsdelivr.net/npm/appwrite@18.2.0"></script>

<style>
/* Reset e base */
body, html {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
  background: #000;
  color: #fff;
}

a {
  flex-direction: column;
}

/* Estilos gerais para Header e Footer */
header, footer {
  position: fixed;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #000;
  padding: 0 16px;
  color: #fff;
  user-select: none;
  z-index: 1000;
}

  /* ===============  */
 /*      Header      */
/* ===============  */
header {
  top: 0;
  height: 56px;
  border-bottom: 1px solid #222; 
  font-weight: 600;
}

.logo-area {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
}

.logo-area img {
  width: 30px;
  height: 30px;
  border-radius: 4px;
  background: #fff;
}

.icons-right a {
  color: #fff;
  text-decoration: none;
  margin-left: 20px;
  display: flex;
  align-items: center;
  transition: color 0.3s ease;
  cursor: pointer;
}

.icons-right svg, header svg {
  width: 24px;
  height: 24px;
  fill: currentColor;
}
  /* ===============  */
 /* botoes-container */
/* ===============  */
.botoes-container {
  display: flex; /* Habilita o Flexbox */
  margin: 30px 0;
  height: 56px;
  justify-content: center; /* Alinha horizontalmente no centro */
  align-items: flex-start; /* Alinha verticalmente no topo */
  gap: 30px;
}

.botoes-container a {
  flex-direction: column;
  color: #fff;
  text-decoration: none;
  font-size: 18px;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: color 0.3s ease;
}

.botoes-container a svg, .botoes-container a img {
  width: 36px;
  height: 36px;
  fill: currentColor;
}

/* Texto */
.botoes-container span {
  font-size: 15px;
  user-select: none;
}

  /* ===============  */
 /*      Footer      */
/* ===============  */
#main-footer, #preview-footer {
  bottom: 0;
  height: 56px;
  border-top: 1px solid #222;
  justify-content: space-around;
  align-items: center;
}

#main-footer a, #preview-footer a {
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  transition: color 0.3s ease;
}

#main-footer a svg, #preview-footer a img {
  width: 24px;
  height: 24px;
  fill: currentColor;
}

/* Texto do footer */
#main-footer span {
  font-size: 10px;
  user-select: none;
}

/* Adaptativo para telas pequenas */
@media screen and (max-width: 600px) {
  header {
    padding: 0 8px;
  }
  #main-footer a {
    font-size: 8px;
    gap: 2px;
  }
  #main-footer a svg {
    width: 20px;
    height: 20px;
  }
  #preview-footer {
    height: 48px;
  }
}

  /*=================*/
 /* Loading Overlay */
/*=================*/
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    flex-direction: column;
    gap: 20px;
}

.loading-overlay.active {
    display: flex;
}

.loading-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #333;
    border-top: 4px solid #6d28d9;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

.loading-text {
    color: #fff;
    font-size: 16px;
    text-align: center;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

h2 {
  margin-top: 30px;
}

input[type="text"] {
  width: 100%;
  height: 50%;
  padding: 8px;
  margin-top: 5px;
  margin-bottom: 20px;
  box-sizing: border-box;
}

main { padding: 70px 16px 90px; text-align: center; }

section { display: none; }           /* todas escondidas */
section.active { display: block; }   /* vis√≠vel */

.botoes-container { bottom: 30vh; }

.logo-area { display: flex; align-items: center; gap: 8px;}
  
.logo-area img { background: #fff; color: #000;  border-radius: 15%;}

.icon {
  width: 24px; 
  height: 24px;
}

.icons-right {
	display: flex;
	align-items: center;
	gap: 20px;
	color: #6d28d9;
	text-decoration: none;
	cursor: pointer;
}

.icons-right a {
	color: #6d28d9;
}

.video-container {
  widht: 100vw;
  max-width: 600px;
  height: 30vh;
  background: #1e1e1e;
  overflow: hidden;
}

video {
    width: 100%;
    border-radius: 4px;
}

.video-title {
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  margin: 2px 0 8px 0;
  text-align: left;
}

.video-text {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.video-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 0 10px 8px;
  font-size: 12px;
}

.video-time {
  position: absolute;
  bottom: 8px;
  right: 8px;
  background: rgba(0,0,0,0.7);
  padding: 2px 6px;
  font-size: 12px;
  border-radius: 4px;
}

.video-section {
    background: ;
    padding: 20px;
    border-radius: 8px;
}

.video-thumb {
 	position: relative;
 	widht: 100vw;
 	max-width: 600px;
  	height: 30vh;
    overflow: hidden;  /* Garante que a imagem n√£o saia da div */
}

.video-thumb img {
  	width: 100%;
    height: 100%;      /* Limita a altura a 100% da altura da div */
    object-fit: cover; /* Ocupa toda a √°rea sem distorcer, mantendo a propor√ß√£o */
  	display: block;
}

.channel-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 0 10px 8px;
  font-size: 12px;;
}

.channel-pic {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

.performance {
  color: #4caf50;
  font-weight: bold;
}

.avatar {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: #6d28d9;
    color: white;
    display: grid;
    place-content: center;
    font-weight: bold;
}

.playlist-item {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}

.playlist-item input {
  margin-right: 10px;
}
</style>
</head>
<body>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
      <div class="loading-spinner"></div>
      <div class="loading-text" id="loadingText">Carregando...</div>
  </div>
  
  <header>
    <div class="logo-area">
      <img src="https://files.catbox.moe/6nkxcx.svg" alt="√çcone SVG" width="30" height="30" />
      <div>PhraseCraft</div>
    </div>
    
    <div class="icons-right">
      <!-- Create -->
      <a href="#" id="icon-create" onclick="showSection('create')" hidden>
        <svg class="icon" viewBox="0 0 24 24">
        <path fill-rule="evenodd" d="M17 10.5V7a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-3.5l4 4V6.5l-4 4zM11 11V9H9v2H7v2h2v2h2v-2h2v-2h-2z"/>
        </svg>
      </a>
      <!-- Search -->
      <a href="#" onclick="showSection('search')">
        <svg class="icon" viewBox="0 0 24 24"><path d="M21 20l-5.8-5.8A7 7 0 1 0 4 11a7 7 0 0 0 11.2 5.6L21 20zM6 11a5 5 0 1 1 10 0a5 5 0 0 1-10 0z"/></svg>
      </a>
      <!-- Notifications -->
      <a href="#" onclick="showSection('notifications')">
      <svg class="icon" viewBox="0 0 24 24"><path d="M12 22a2.5 2.5 0 0 0 2.5-2.5h-5A2.5 2.5 0 0 0 12 22zm6-6V11c0-3.3-2.2-6-5-6V4a1 1 0 1 0-2 0v1c-2.8 0-5 2.7-5 6v5l-1.9 1.9A1 1 0 0 0 6 20h12a1 1 0 0 0 .9-1.6L18 16z"/></svg>
      </a>
    </div>
  </header>

    <!-- Elementos compartilhados -->
    <video id="shared-video" controls hidden>
      <source src="video.mp4" type="video/mp4" />
      Seu navegador n√£o suporta v√≠deo HTML5.
    </video>

    <div id="shared-text" hidden>Este √© um conte√∫do compartilhado e fixo.</div>

    <img id="shared-image" src="imagem.jpg" alt="Imagem compartilhada" hidden />

  <main>
    <!-- Se√ß√µes -->
    <section id="home">
        <h2>Home</h2>
        <p>Welcome to the home section.</p>
        <div id="home-post-container">
            <!-- Os cards de v√≠deo ser√£o inseridos aqui -->
        </div>
    </section>

    <section id="search">
      <h2>Search</h2>
      <p>Use this section to search content.</p>
    </section>

    <section id="notifications">
      <h2>Notifications</h2>
      <p>Here are your notifications.</p>
    </section>

    <section id="you">
      <h2>You</h2>
      <p>This section is about your profile.</p>
                      
      <div class="botoes-container">
        <a href="#" onclick="showSection('myProfile')">
            <img src="https://files.catbox.moe/r8near.png" alt="√çcone SVG" width="21" height="21" /><span>Meu Perfil</span></a>
        <a href="#" id="btn-myPosts" onclick="showSection('myPosts')">
            <img src="https://files.catbox.moe/48dken.svg" alt="√çcone SVG" width="21" height="21" /><span>Minhas Postagens</span></a>
      </div>
    
    </section>

    <section id="subscriptions">
      <h2>Subscriptions</h2>
      <p>See all your subscriptions here.</p>
    </section>

    <section id="create">
        <h2>Create</h2>
        <p>Use this section to create new content.</p>
        <div class="load-group">
            <label for="videoUpload" class="upload-btn">Upload V√≠deo</label>
            <input type="file" id="videoUpload" accept="video/*">
        </div>
        <div class="load-group">
            <label for="srtUpload" class="upload-btn">Upload SRT</label>
            <input type="file" id="srtUpload" accept=".srt">
        </div>

        <div class="botoes-container">
            <a href="#" onclick="openContent()">üìÅ<span>Carregar<span></a>
        </div>
    </section>
    
    <!-- Subsections -->
    <section id="login-screen" class="login-screen-container">
        <div class="login-card">
            <h2>Entrar</h2>
            <form id="login-form">
                <input type="email" id="email-login" placeholder="E-mail" required>
                <input type="password" id="password-login" placeholder="Senha" required>
                <p id="login-message"></p>
                <button type="submit" class="login-button">Entrar</button>
            </form>
        </div>
    </section>
    
    <section id="myProfile">
      <h2>My Account</h2>
      <p>Use this section to see and edit your profile.</p>
      <div class="header-content"  id="header-content">
      
        <div class="user-buttons">
            <div id="user-email-display" style="font-size: 0.9em; color: rgba(255, 255, 255, 0.7);"></div>

			<div class="">
				<button id="btnLogin" class="btnLogin" onclick="showSection('login-screen')">Entrar</button><hr>
            	<button id="logout-button" class="" onclick="handleLogout()" >Sair</button>
            </div>
            
        </div>
      </div>
    </section>
    
    <section id="postLesson">
      <h2>Post</h2>
      <p>Use this section to post.</p>
                      
      <div class="botoes-container">
          <button href="#" onclick="postLesson()">Postar Li√ß√£o</button>
      </div>
                      
      <div class="botoes-container">
          <button onclick="showSection('editSrt')">Editar Srt</button>
      </div>

      <div id="postPlayerContainer" class="video-section"></div>

      <button id="captureBtn" class="thumb-gen-button">üì∏ Capturar Thumbnail</button>

      <div id="previewContainer" class="thumb-gen-preview">
          <span>A pr√©-visualiza√ß√£o da sua thumbnail aparecer√° aqui.</span>
      </div>
      
      <!-- T√≠tulo -->
      <h2>Nome</h2>
      <!-- Input de texto -->
      <input type="text" placeholder="Digite um nome..." name="nome" />
      
      <!-- T√≠tulo -->
      <h2>Descri√ß√£o</h2>
      <!-- Input de texto -->
      <input type="text" placeholder="Digite uma descri√ß√£o..." name="description" />

      <!-- T√≠tulo -->
      <h2>Adicionar √† Playlist</h2>
      <!-- Lista de checkboxes com nomes de playlists -->
      <div class="playlist-item">
        <input type="checkbox" id="playlist1" name="playlist" value="Playlist 1" />
        <label for="playlist1">Playlist 1</label>
      </div>

      <div class="playlist-item">
        <input type="checkbox" id="playlist2" name="playlist" value="Playlist 2" />
        <label for="playlist2">Playlist 2</label>
      </div>

      <div class="playlist-item">
        <input type="checkbox" id="playlist3" name="playlist" value="Playlist 3" />
        <label for="playlist3">Playlist 3</label>
      </div>
      
    </section>
    
    <section id="myPosts">
        <h2>My Lessons Posts</h2>
        <p>Use this section to see your lessons posted.</p>
        <div id="user-post-container">
            <!-- Os cards de v√≠deo do usu√°rio ser√£o inseridos aqui -->
        </div>
    </section>

    <section id="play" class="content-row">
            <div class="video-container">
                <video id="mainVideoPlayer" class="hide-controls" preload="auto" crossorigin="anonymous"></video>
        
                <div id="subtitle-content" class="hidden"> 
                	<!- As legendas aparecem aqui: -->
                </div>
            </div>

            <div id="buttons">
                <button id="repetir" class="control-button" style="background: linear-gradient(to bottom, #b34dd6 0%, #9C27B0 50%, #7c1f8e 100%);">Tocar Trecho</button>
                <button id="lerFrase" class="control-button" style="background: linear-gradient(to bottom, #78c0ff 0%, #5babf0 50%, #4d98e5 100%);">Tocar Lento</button>
                <button id="traduzir-btn" class="control-button" style="background: linear-gradient(to bottom, #ffc078 0%, #ffa94d 50%, #e59442 100%);">Traduzir</button>
                <button id="desistir" class="control-button" style="background: linear-gradient(to bottom, #ff5e91 0%, #E91E63 50%, #c41858 100%);">Passar</button>
                
             </div>
        </div>

        <div class="phrase-container" id="frase">
        </div>

        <div class="word-button-wrapper">
            <div class="word-container" id="palavras"></div>
        </div>
        
        <div id="progresso" style="margin-top: 10px; font-size: 0.9em;">Progresso: 0 de 0</div>
    </section>

    <section id="challenge" class="">
      <!-- Criadas -->
      <h2>Partidas Criadas</h2>
      <p>Use this section to see all matches waiting a second player.</p>
    </section>
    
    <section id="editSrt">
      <h2>Editar SRT</h2>
      <div class="editor" id="editor">

        <!-- Div para exibir o nome do arquivo da legenda -->
        <p id="subtitleName"></p>

        <div id="editPlayerContainer" class="video-section"></div>
        
        <label>In√≠cio</label>
        <div class="time-controls">
          <input id="editStart">
          <button onclick="adjustTime('start',  -TIME_STEP)">‚àí</button>
          <button onclick="adjustTime('start', +TIME_STEP)">+</button>

          <button onclick="undo()">‚Ü©</button>
          <button onclick="redo()">‚Ü™</button>
        </div>

        <label>Fim</label>
        <div class="time-controls">
          <input id="editEnd">
          <button onclick="adjustTime('end', -TIME_STEP)">‚àí</button>
          <button onclick="adjustTime('end', +TIME_STEP)">+</button>

          <button onclick="addSegment()">‚ò∞ ‚ûïÔ∏è</button>
          <button onclick="removeSegment()">‚ò∞ ‚ûñ</button>
        </div>

        <label>Texto</label>
        <textarea id="editText" rows="3"></textarea>

        <button id="btn-load" onclick="showLoadArea()">üìÇ</button>
        <button onclick="prevLine()">‚óÄ‚óÄ</button>
        <button onclick="playLine()">‚ñ∂</button>
        <button onclick="nextLine()">‚ñ∂‚ñ∂</button>
        <button id="btn-save" onclick="showSaveArea()">üíæ</button>

        <p id="btn-config" onclick="showConfigEdit()">‚öô Editar em Lote</p>

        <div id="config-area" hidden>
            <span id="btn-close" onclick="closeConfigEdit()">&times;</span>
            <div class="time-controls">
              <input id="editStack" placeholder="0.05">
              <button onclick="showEarlier()">Adiantar</button>
              <button onclick="showLater()">Atrasar</button>
            </div>

            <form id="linhaForm">
              <label class="radio-option">
                <input type="radio" name="opcao-linha" value="all" checked>
                Todas as linhas
              </label>
              <label class="radio-option">
                <input type="radio" name="opcao-linha" value="current">
                Apenas linha atual
              </label>

            <label class="radio-option">
              <input type="radio" name="opcao-linha" value="from-current">
              Linha selecionada e pr√≥ximas linhas
            </label>
            </form>
            <hr>
        </div>
    </div>

    <div class="segmentsArea" id="segments-area">
        <div id="segments"></div>
    </div>
    </section>

  </main>  

  <footer id="main-footer">
    <a href="#" onclick="showSection('home')">
      <svg viewBox="0 0 24 24"><path d="M12 3.3l8 6V20a1 1 0 0 1-1 1h-5v-6H10v6H5a1 1 0 0 1-1-1V9.3l8-6z"/></svg>
      <span>Home</span>
    </a>
    <a href="#" onclick="showSection('subscriptions')">
      <svg viewBox="0 0 24 24"><path d="M17 10.5V7a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-3.5l4 4V6.5l-4 4z"/></svg>
      <span>Subscriptions</span>
    </a>
    <a href="#" onclick="showSection('you')">
        <img src="https://files.catbox.moe/p2znlg.svg" alt="√çcone SVG" width="21" height="21" /><span>You</span></a>
    <a href="#" onclick="showSection('challenge')">
        <img src="https://files.catbox.moe/tdzklr.svg" alt="√çcone SVG" width="25" height="25" /><span>Desafios</span></a>
  </footer>

  <footer id="preview-footer" style="display: none;">
    <a href="#" onclick="showSection('play')">
        <img src="https://files.catbox.moe/p2znlg.svg" alt="√çcone SVG" width="21" height="21" /><span>Solo</span></a>
    <a href="#" onclick="showSection('')">
        <img src="https://files.catbox.moe/tdzklr.svg" alt="√çcone SVG" width="25" height="25" /><span>Desafiar</span></a>
  </footer>

<script>
let videoMode = false;

// ‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò
// GERENCIAMENTO DE SE√á√ïES 
// ‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò

// Lista de elementos com condi√ß√µes
const elements = [
  {
    id: "video-content",
    content: `
    <p>Video Element:</p>
    <div class="video-content">
        <video id="bigBuckBunnyVideo" controls autoplay>
            <source src="-http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
            Seu navegador n√£o suporta a tag de v√≠deo.
        </video>
    </div>`,
    condition: () => true
  },
  {
    id: "srt-content",
    content: `
    <div>
      <source src="legendas.srt" type="" />
        Este √© uma srt compartilhada e fixo.
    </div>`,
    condition: () => true
  },
  {
    id: "edit-controls-content",
    content: `
    <div>
        Este √© um elemento compartilhada e fixo.
    </div>`,
    condition: () => true
  },
  {
    id: "lobby",
    content: `
    <div id="lobby">
        Aguardando jogador...
    </div>`,
    condition: () => videoMode
  }
];

// Lista de sections com condi√ß√µes
const sections = [
  { id: "home", condition: () => true },
  { id: "search", condition: () => true },
  { id: "notifications", condition: () => true },
  { id: "you", condition: () => true },
  { id: "subscriptions", condition: () => true },
  { id: "create", condition: () => true },
  { id: "postLesson", condition: () => true },
  { id: "editSrt", condition: () => true },
  { id: "myProfile", condition: () => true },
  { id: "myPosts", condition: () => true },
  { id: "login-screen", condition: () => true },
  { id: "play", condition: () => true },
  { id: "challenge", condition: () => true },
];

// Lista de posi√ß√µes (elementos podem aparecer em v√°rias se√ß√µes)
const positions = [
  { key: "video-content", after: ["home-post-container", "user-post-container"] },
  { key: "edit-controls-content", after: ["editSrt"] },
  { key: "srt-content", after: ["editSrt", ""] },
];

// Renderiza se√ß√µes e elementos
function renderPage() {
  // Encontra a se√ß√£o ativa
  const activeSection = document.querySelector('section.active');
  if (!activeSection) return;

  elements.forEach(element => {
    const shouldShow = element.condition();
    if (!shouldShow) return;

    const pos = positions.find(p => p.key === element.id);
    if (!pos) return;

    // Procura o container correto dentro da se√ß√£o ativa
    let container = null;
    for (const targetId of pos.after) {
      const candidate = activeSection.querySelector(`#${targetId}`);
      if (candidate) {
        container = candidate;
        break;
      }
    }
    if (!container) return;

    let existing = document.getElementById(element.id);
    if (!existing) {
      const div = document.createElement('div');
      div.id = element.id; // id √∫nico global para o elemento
      div.innerHTML = element.content;
      container.appendChild(div);
    } else {
      // Move o elemento para o container da se√ß√£o ativa
      container.appendChild(existing);
      existing.style.display = "block";
    }
  });
}

// Bot√£o para mostrar/ocultar se√ß√µes
function showSection(sectionId) {
  const section = sections.find(s => s.id === sectionId);
  
  // Se a se√ß√£o n√£o existe ou a condi√ß√£o dela √© falsa, n√£o fa√ßa nada
  if (!section || !section.condition()) {
    return; // Sai da fun√ß√£o sem alterar nada
  }
  
  sections.forEach(s => {
    const el = document.getElementById(s.id);
    if (el) el.classList.remove("active");
  });
  
  const target = document.getElementById(sectionId);
  if (target) target.classList.add("active");
  
  renderPage();
}

// ‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò
// ----- Bloco Fx | Login ----- 
// ‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò

// Configura√ß√£o do Appwrite
const client = new Appwrite.Client()
        .setEndpoint('https://nyc.cloud.appwrite.io/v1')
        .setProject('68ebe8640000ca7c860b');

const account = new Appwrite.Account(client);

// Seletores de elementos HTML (TODOS JUNTOS AQUI)

const btnLoginHeader = document.getElementById('btnLogin');

const loginForm = document.getElementById('login-form');
const logoutButton = document.getElementById('logout-button');
const userEmailDisplay = document.getElementById('user-email-display');
const iconCreate = document.getElementById('icon-create');
const btnMyPosts = document.getElementById('btn-myPosts');

const loginMessage = document.getElementById('login-message');

// Fun√ß√£o para verificar o status de login
let isCheckingAuth = false;

async function checkAuthStatus() {
    // Verifica se j√° h√° uma sess√£o em cache
    const cachedEmail = localStorage.getItem('userEmail');
    if (cachedEmail) {
        renderUIForAuthState(true, cachedEmail);
        showSection('myPosts');
        return;
    }
    
    showLoading('Carregando...');
    console.log('Verificando sess√£o...')
    
    try {
        const user = await account.get();
        // Salva o email no cache
        localStorage.setItem('userEmail', user.email);
        renderUIForAuthState(true, user.email);
        showSection('myPosts');
    } catch (error) {
    	console.log('Usu√°rio n√£o est√° logando. Direcinando para "home"...')
        // Remove cache se houver erro
        localStorage.removeItem('userEmail');
        renderUIForAuthState(false);
        showSection('home');
    } finally {
        hideLoading();
    }
}
    
// Evento de submiss√£o do formul√°rio de login
loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('email-login').value;
    const password = document.getElementById('password-login').value;
    loginMessage.textContent = '';
    
    showLoading('Entrando...');
    
    try {
        // Primeiro tenta deletar qualquer sess√£o existente
        try {
            await account.deleteSession('current');
        } catch (error) {
            // Ignora erro se n√£o houver sess√£o ativa
        }
        
        // Agora cria a nova sess√£o
        await account.createEmailPasswordSession(email, password);
        
        // Atualiza a interface
        const user = await account.get();
        // Salva no cache
        localStorage.setItem('userEmail', user.email);
        renderUIForAuthState(true, user.email);
        showSection('myPosts');
    } catch (error) {
        loginMessage.textContent = 'Erro no login: ' + error.message;
    } finally {
        hideLoading();
    }
});

// Fun√ß√£o de logout
function handleLogout() {
    showLoading('Saindo...');
    
    account.deleteSession('current')
        .then(() => {
            localStorage.removeItem('userEmail');
            renderUIForAuthState(false);
            showSection('home');
        })
        .catch((error) => {
            console.error('Erro ao fazer logout:', error);
        })
        .finally(() => {
            hideLoading();
        });
}
    
/* Fun√ß√£o para renderizar a interface de
    ** acordo com o estado de autentica√ß√£o */
function renderUIForAuthState(isLoggedIn, userEmail = '') {
    // Esconde tudo primeiro
    iconCreate.style.display = 'none';
    btnMyPosts.style.display = 'none';
    btnLoginHeader.style.display = 'none';
    logoutButton.style.display = 'none';
    userEmailDisplay.style.display = 'none';
    
    // Garantir que a tela de login seja escondida
    document.getElementById('login-screen').classList.remove('active');

    if (isLoggedIn) {
        // Mostra email e bot√£o sair
        userEmailDisplay.textContent = userEmail;
        userEmailDisplay.style.display = 'block';
        logoutButton.style.display = 'block';
    	iconCreate.style.display = 'block';
	    btnMyPosts.style.display = 'flex';
    } else {
        // Mostra apenas bot√£o entrar
        btnLoginHeader.style.display = 'block';
    }
}

// Fun√ß√£o para mostrar perfil ou tela de login
async function showProfile() {
    try {
        const user = await account.get();
        // Se conseguiu pegar o usu√°rio, est√° logado
        showSection('myProfile');
    } catch (error) {
        // Se deu erro, n√£o est√° logado
        showSection('login-screen');
    }
}

checkAuthStatus();

// ‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò
// ----- Bloco Fx | Loading ----- 
// ‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò‚´ò

/**
 * Mostra o overlay de loading
 * @param {string} message - Mensagem a ser exibida (opcional)
 */
function showLoading(message = 'Carregando...') {
    const overlay = document.getElementById('loadingOverlay');
    const text = document.getElementById('loadingText');
    if (text) text.textContent = message;
    if (overlay) overlay.classList.add('active');
}

/**
 * Esconde o overlay de loading
 */
function hideLoading() {
    const overlay = document.getElementById('loadingOverlay');
    if (overlay) overlay.classList.remove('active');
}

// Inicializa
document.addEventListener("DOMContentLoaded", () => {
  renderPage();
  showSection("home");
});
</script>
</body>
</html>
